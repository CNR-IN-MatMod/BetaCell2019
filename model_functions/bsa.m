function bsa=bsa(weight,height,method)% bsa=bsa(weight,height,method) calculates the body surface area according% to various methods% weight: kg; height: m or cm (scale automatically determined); bsa: m^2% method:%    'gege': Gehan & George (default, i.e. method is missing)%    'dbdb': DuBois & DuBois%    'boyd': Boyd% see B.J.R Bailey & G.L. Briars, Estimating the surface area of the human%    body, Statistics in Medicine 15:1325-1332 (1996) for a summary of methods% bsa returns a vector if weight and height are vectors% See also BMI% convert height to m if necessaryif median(height(~isnan(height)))>3    height=height/100;endif nargin<3 method='gege'; endswitch method    case 'gege'        bsa=0.16404439582980*weight.^0.515.*height.^0.422;    case 'dbdb'        bsa=0.2024726*weight.^0.425.*height.^0.725;    case 'boyd'        bsa=0.17863424153314*weight.^0.484.*height.^0.5;    otherwise        error(['method ' method ' does not exist'])end% return real values (NaNs may be complex)bsa=real(bsa);
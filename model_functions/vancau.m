function [p,cl,vol]=vancau(type,sex,age,weight,height)% [p,cl,vol]=vancau(type,sex,age,weight,height) calculates the parameters% of the C-peptide impulse response according to van Cauter's model% (Van Cauter E. et al., Diabetes 41:368-377, 1992).%% type ('lean', 'obese', 'ND' (nondiabetic) or 'T2D' (type 2 diabetic))% defines the subject class according to van Cauter's classification. The% type 'ND' is converted into the type 'lean' if the subject's BMI is <=27,% otherwise into the type 'obese' (Jeppe Sturis, personal communication).%% sex ('M' or 'F'), age (years), height (m or cm) and weight (kg) are the% anthropometric parameters%% The input arguments can be scalars or vectors of the same dimensions.%% The output arguments are the parameter of the two-exponential impulse% response (p; see convmatexp for the format), C-peptide clearance (cl,% l/min) and volume (vol, l). With these units, if C-peptide is in pM% (pmol/l), insulin secretion is in pmol/min. The size of vol and cl is the% same as the size of the input vectors. The size of p is 4xN, where N is% the size of the input vectors. Warning: NaNs are returned if p cannot be% calculated (e.g. if type or sex are incorrect), but no error message is% displayed.%% If the input arguments are scalars, the C-peptide model parameter p is% suitable for direct calculation of the convolution matrix (see% convmatexp, vancaudec).%% Assumptions:% Body surface area (needed in van Cauter's formulas) is calculated% according to DuBois e DuBois (the BSA method is not specified in the% paper).%% Note: this version replaces the previous version that was valid only for% scalar arguments, and is backward compatible (the code 'NIDDM' is allowed% and is equivalent to 'T2D')% check typeif ~all(ismember(type,{'lean' 'obese' 'ND' 'T2D' 'NIDDM'}))    error('Type must be ''lean'', ''obese'', ''ND'' or ''T2D''')end% convert height to m if necessaryif nanmedian(height)>3    height=height/100;end% BMI obesity threshold: 27 kg/m^2 (J.Sturis, personal communication)bmithr=27;% calculate BSA (DuBois e DuBois) and BMIbsas=bsa(weight,height,'dbdb');bmis=bmi(weight,height);% adjust parameters according to subject categorytshort=nan(size(weight));fraction=nan(size(weight));s=strcmp(type,'lean')|(strcmp(type,'ND')&bmis<=bmithr);tshort(s)=4.95;fraction(s)=0.76;s=strcmp(type,'obese')|(strcmp(type,'ND')&bmis>bmithr);tshort(s)=4.55;fraction(s)=0.78;s=strcmp(type,'T2D')|strcmp(type,'NIDDM');tshort(s)=4.52;fraction(s)=0.78;% set parameters for distribution volume function according to sexvsl=nan(size(weight));vint=nan(size(weight));s=strcmp(sex,'M');vsl(s)=1.92;vint(s)=0.64;s=strcmp(sex,'F');vsl(s)=1.11;vint(s)=2.04;% calculate volume and long half-lifevol=vsl.*bsas+vint; % literstlong=0.14*age+29.2;% calculate parameters of the two-exponential responsea1=fraction./vol;e1=log(2)./tshort;a2=1./vol-a1;e2=log(2)./tlong;% assemble parameters in standard formp=[a1 a2 e1 e2]';% calculate clearancecl=1./(a1./e1+a2./e2);